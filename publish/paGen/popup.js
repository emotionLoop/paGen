// Generated by CoffeeScript 1.4.0
(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d;r={type:"single",chars:14,howmany:1,security:{lowercase:!0,uppercase:!0,special:!0,punctuation:!0,readable:!1}};f=r;d={single:"190px",multiple:"270px",settings:"355px"};String.prototype.shuffle=function(){var e,t,n,r,i;e=this.split("");r=e.length;t=r-1;while(t>0){n=Math.floor(Math.random()*(t+1));i=e[t];e[t]=e[n];e[n]=i;--t}return e.join("")};i=function(e,t){var n;for(n in t)e[n]=t[n];return e};h=function(e){var t;t=window.webkitNotifications.createNotification("icon.png",window.chrome.i18n.getMessage("error"),""+e);t.show();return!1};c=function(e){var t;t=window.webkitNotifications.createNotification("icon.png",window.chrome.i18n.getMessage("information"),""+e);t.show();return!1};n=function(){var e,t,n,r;t=document.getElementsByClassName("apply-i18n");n=0;while(n<t.length){e=t[n];r=e.innerHTML;e.innerHTML=window.chrome.i18n.getMessage(r);++n}t=document.getElementsByClassName("apply-i18n-placeholder");n=0;while(n<t.length){e=t[n];r=e.placeholder;e.placeholder=window.chrome.i18n.getMessage(r);++n}t=document.getElementsByClassName("apply-i18n-title");n=0;while(n<t.length){e=t[n];r=e.title;e.title=window.chrome.i18n.getMessage(r);++n}t=document.getElementsByClassName("apply-i18n-alt");n=0;while(n<t.length){e=t[n];r=e.alt;e.alt=window.chrome.i18n.getMessage(r);++n}return!0};p=function(e,t){e||(e=f);if(!e.type||e.type!=="single"&&e.type!=="multiple"){t&&h(window.chrome.i18n.getMessage("validateType"));!1}if(!e.chars||isNaN(e.chars||e.chars<1||e.chars>128)){t&&h(window.chrome.i18n.getMessage("validateChars"));!1}if(!e.howmany||isNaN(e.howmany||e.howmany<1||e.howmany>20)){t&&h(window.chrome.i18n.getMessage("validateHowMany"));!1}if(!e.security.lowercase&&!e.security.uppercase&&!e.security.special&&!e.security.punctuation){t&&h(window.chrome.i18n.getMessage("validateComplexity"));!1}return!0};t=function(){if(f.type==="single"){document.getElementById("generator-form").getElementsByClassName("single")[0].style.display="block";document.getElementById("generator-form").getElementsByClassName("multiple")[0].style.display="none";document.getElementById("main-screen").style.height=d.single;document.getElementById("settingsSingle").checked=!0;document.getElementById("settingsMultiple").checked=!1}else{document.getElementById("generator-form").getElementsByClassName("multiple")[0].style.display="block";document.getElementById("generator-form").getElementsByClassName("single")[0].style.display="none";document.getElementById("main-screen").style.height=d.multiple;document.getElementById("settingsMultiple").checked=!0;document.getElementById("settingsSingle").checked=!1}document.getElementById("single-passwords-length").value=f.chars;document.getElementById("multiple-passwords-length").value=f.chars;document.getElementById("passwords-number").value=f.howmany;document.getElementById("settingsLowercase").checked=f.security.lowercase;document.getElementById("settingsUppercase").checked=f.security.uppercase;document.getElementById("settingsSpecial").checked=f.security.special;document.getElementById("settingsPunctuation").checked=f.security.punctuation;document.getElementById("settingsReadable").checked=f.security.readable;f.type==="single"?document.getElementById("single-passwords-length").focus():document.getElementById("multiple-passwords-length").focus();return!0};l=function(e,n){if(p(e,!0)){window.chrome.storage.sync.set({settings:e},function(){if(chrome.runtime.lastError&&chrome.runtime.lastError.message&&chrome.runtime.lastError.message.indexOf(!0))return window.chrome.storage.local.set({settings:e},function(){f=e;n&&c(window.chrome.i18n.getMessage("settingsSaved"));t();return!0});f=e;n&&c(window.chrome.i18n.getMessage("settingsSaved"));t();return!0});return!0}return!1};u=function(){return window.chrome.storage.sync.get("settings",function(e){var n;if(e.settings){n=i(f,e.settings);if(p(n,!1)){f=n;t()}return!0}window.chrome.storage.local.get("settings",function(e){if(e.settings){n=i(f,e.settings);p(n,!1)&&(f=n)}return t()});return!0})};a=function(){var e;e={};document.getElementById("settingsSingle").checked?e.type="single":e.type="multiple";if(e.type==="single"){e.chars=window.parseInt(document.getElementById("single-passwords-length").value);e.howmany=1}else{e.chars=window.parseInt(document.getElementById("multiple-passwords-length").value);e.howmany=window.parseInt(document.getElementById("passwords-number").value)}e.security={};e.security.lowercase=document.getElementById("settingsLowercase").checked;e.security.uppercase=document.getElementById("settingsUppercase").checked;e.security.special=document.getElementById("settingsSpecial").checked;e.security.punctuation=document.getElementById("settingsPunctuation").checked;e.security.readable=document.getElementById("settingsReadable").checked;return e};o=function(e,t){var n,r,i;i=[];n=0;while(n<e){r=Math.floor(Math.random()*t.length);i.push(t.substring(r,r+1));++n}return i.join("")};s=function(e){var t,n,r;n=[];if(!e||!p(e,!1))e=f;t=[];e.security.lowercase&&(e.security.readable?t.push("abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz"):t.push("abcdefghijklmnopqrstuvwxyz"));e.security.uppercase&&(e.security.readable?t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZ"):t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZ"));e.security.special&&(e.security.readable?t.push("áÁéÉàÀèÈçÇ"):t.push("áÁéÉíÍóÓúÚàÀèÈìÌòÒùÙäÄëËïÏöÖüÜçÇ"));e.security.punctuation&&(e.security.readable?t.push("!.,;:?#&*%-"):t.push("!.,;:?^~`´<>”·ˆ‹›#&*%-()[]{}"));t=t.join("").shuffle();r=0;while(r<e.howmany){n.push(o(e.chars,t));++r}e.type==="single"?document.getElementById("password-input").value=n.join(""):document.getElementById("passwords-textarea").value=n.join("\n");return!0};e=function(e,t,n){var r,i,s;for(i=0,s=e.length;i<s;i++){r=e[i];r.addEventListener(t,n,!1)}return!0};window.chrome.storage.onChanged.addListener(function(e,t){var n,r;if(t==="sync"){for(n in e)n==="settings"&&(r=i(f,e[n]));r&&l(r,!1)}return!0});document.getElementById("generator-form").addEventListener("submit",function(e){e.preventDefault();return!1});document.getElementById("settings-form").addEventListener("submit",function(e){e.preventDefault();return!1});document.getElementById("settings-cog").addEventListener("click",function(e){var t,n;e.preventDefault();document.getElementById("main-screen").style.height="0px";t=function(){document.getElementById("main-screen").style.display="none";return!0};window.setTimeout(t,300);document.getElementById("settings-screen").style.display="block";document.getElementById("settings-screen").style.height="0px";n=function(){document.getElementById("settings-screen").style.height=d.settings;return!0};window.setTimeout(n,10);return!0});e(document.getElementById("settings-screen").getElementsByClassName("go-back"),"click",function(e){var t,n;e.preventDefault();document.getElementById("settings-screen").style.height="0px";t=function(){document.getElementById("settings-screen").style.display="none";return!0};window.setTimeout(t,300);document.getElementById("main-screen").style.display="block";document.getElementById("main-screen").style.height="0px";n=function(){f.type==="single"?document.getElementById("main-screen").style.height=d.single:document.getElementById("main-screen").style.height=d.multiple;return!0};window.setTimeout(n,10);return!0});document.getElementById("save-settings").addEventListener("click",function(e){var t;e.preventDefault();t=a();l(t,!0)&&document.getElementById("settings-screen").getElementsByClassName("go-back")[0].click();return!0});e(document.getElementsByClassName("generate-password"),"click",function(e){var t;e.preventDefault();t=a();l(t,!1);s(t);return!0});u();n()}).call(this);