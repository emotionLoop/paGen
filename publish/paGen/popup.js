(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p;r={type:"single",chars:14,howmany:1,security:{lowercase:!0,uppercase:!0,numbers:!0,special:!0,punctuation:!0,readable:!1}};f=r;String.prototype.shuffle=function(){var e,t,n,r,i;e=this.split("");r=e.length;t=r-1;while(t>0){n=Math.floor(Math.random()*(t+1));i=e[t];e[t]=e[n];e[n]=i;--t}return e.join("")};i=function(e,t){var n;for(n in t)e[n]=t[n];return e};h=function(e){var t;t=window.webkitNotifications.createNotification("icon.png",window.chrome.i18n.getMessage("error"),""+e);t.show();return!1};c=function(e){var t;t=window.webkitNotifications.createNotification("icon.png",window.chrome.i18n.getMessage("information"),""+e);t.show();return!1};n=function(){var e,t,n,r;t=document.getElementsByClassName("apply-i18n");n=0;while(n<t.length){e=t[n];r=e.innerHTML;e.innerHTML=window.chrome.i18n.getMessage(r);++n}t=document.getElementsByClassName("apply-i18n-placeholder");n=0;while(n<t.length){e=t[n];r=e.placeholder;e.placeholder=window.chrome.i18n.getMessage(r);++n}t=document.getElementsByClassName("apply-i18n-title");n=0;while(n<t.length){e=t[n];r=e.title;e.title=window.chrome.i18n.getMessage(r);++n}t=document.getElementsByClassName("apply-i18n-alt");n=0;while(n<t.length){e=t[n];r=e.alt;e.alt=window.chrome.i18n.getMessage(r);++n}return!0};p=function(e,t){e||(e=f);if(!e.type||e.type!=="single"&&e.type!=="multiple"){t&&h(window.chrome.i18n.getMessage("validateType"));return!1}if(!e.chars||isNaN(e.chars||e.chars<1||e.chars>128)){t&&h(window.chrome.i18n.getMessage("validateChars"));return!1}if(!e.howmany||isNaN(e.howmany||e.howmany<1||e.howmany>20)){t&&h(window.chrome.i18n.getMessage("validateHowMany"));return!1}if(!e.security.lowercase&&!e.security.uppercase&&!e.security.numbers&&!e.security.special&&!e.security.punctuation){t&&h(window.chrome.i18n.getMessage("validateComplexity"));return!1}return!0};t=function(e){e?e=!0:e=!1;if(f.type==="single"){document.getElementById("generator-form").getElementsByClassName("single")[0].style.display="block";document.getElementById("generator-form").getElementsByClassName("multiple")[0].style.display="none";document.getElementById("settingsSingle").checked=!0;document.getElementById("settingsMultiple").checked=!1}else{document.getElementById("generator-form").getElementsByClassName("multiple")[0].style.display="block";document.getElementById("generator-form").getElementsByClassName("single")[0].style.display="none";document.getElementById("settingsMultiple").checked=!0;document.getElementById("settingsSingle").checked=!1}document.getElementById("single-passwords-length").value=f.chars;document.getElementById("multiple-passwords-length").value=f.chars;document.getElementById("passwords-number").value=f.howmany;document.getElementById("settingsLowercase").checked=f.security.lowercase;document.getElementById("settingsUppercase").checked=f.security.uppercase;document.getElementById("settingsNumbers").checked=f.security.numbers;document.getElementById("settingsSpecial").checked=f.security.special;document.getElementById("settingsPunctuation").checked=f.security.punctuation;document.getElementById("settingsReadable").checked=f.security.readable;e&&(f.type==="single"?window.setTimeout(function(){document.getElementById("single-passwords-length").focus();return!0},100):window.setTimeout(function(){document.getElementById("multiple-passwords-length").focus();return!0},100));return!0};l=function(e,n){if(p(e,!0)){window.chrome.storage.sync.set({settings:e},function(){if(window.chrome.runtime.lastError&&window.chrome.runtime.lastError.message&&window.chrome.runtime.lastError.message.indexOf("MAX_WRITE_OPERATIONS_PER_HOUR")!==-1)return window.chrome.storage.local.set({settings:e},function(){f=e;n&&c(window.chrome.i18n.getMessage("settingsSaved"));t();return!0});f=e;n&&c(window.chrome.i18n.getMessage("settingsSaved"));t();return!0});return!0}return!1};u=function(e){e?e=!0:e=!1;return window.chrome.storage.sync.get("settings",function(n){var r;if(n.settings){r=i(f,n.settings);if(p(r,!1)){f=r;t(e)}return!0}window.chrome.storage.local.get("settings",function(n){if(n.settings){r=i(f,n.settings);p(r,!1)&&(f=r)}return t(e)});return!0})};a=function(){var e;e={};document.getElementById("settingsSingle").checked?e.type="single":e.type="multiple";if(e.type==="single"){e.chars=window.parseInt(document.getElementById("single-passwords-length").value);e.howmany=1}else{e.chars=window.parseInt(document.getElementById("multiple-passwords-length").value);e.howmany=window.parseInt(document.getElementById("passwords-number").value)}e.security={};e.security.lowercase=document.getElementById("settingsLowercase").checked;e.security.uppercase=document.getElementById("settingsUppercase").checked;e.security.numbers=document.getElementById("settingsNumbers").checked;e.security.special=document.getElementById("settingsSpecial").checked;e.security.punctuation=document.getElementById("settingsPunctuation").checked;e.security.readable=document.getElementById("settingsReadable").checked;return e};o=function(e,t){var n,r,i;i=[];n=0;while(n<e){r=Math.floor(Math.random()*t.length);i.push(t.substring(r,r+1));++n}return i.join("")};s=function(e){var t,n,r;n=[];if(!e||!p(e,!1))e=f;t=[];e.security.lowercase&&(e.security.readable?t.push("abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz"):t.push("abcdefghijklmnopqrstuvwxyz"));e.security.uppercase&&(e.security.readable?t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZ"):t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZ"));e.security.numbers&&(e.security.readable?t.push("0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"):t.push("012345678901234567890123456789"));e.security.special&&(e.security.readable?t.push("áÁéÉàÀèÈçÇ"):t.push("áÁéÉíÍóÓúÚàÀèÈìÌòÒùÙäÄëËïÏöÖüÜçÇ"));e.security.punctuation&&(e.security.readable?t.push("!.,;:?#&*%-"):t.push("!.,;:?^~`´<>”·ˆ‹›#&*%-()[]{}"));t=t.join("").shuffle();r=0;while(r<e.howmany){n.push(o(e.chars,t));++r}e.type==="single"?document.getElementById("password-input").value=n.join(""):document.getElementById("passwords-textarea").value=n.join("\n");return!0};e=function(e,t,n){var r,i,s;for(i=0,s=e.length;i<s;i++){r=e[i];r.addEventListener(t,n,!1)}return!0};document.getElementById("generator-form").addEventListener("submit",function(e){e.preventDefault();return!1});document.getElementById("settings-form").addEventListener("submit",function(e){e.preventDefault();return!1});document.getElementById("settings-cog").addEventListener("click",function(e){e.preventDefault();document.getElementById("main-screen").style.display="none";document.getElementById("settings-screen").style.display="block";return!0});e(document.getElementById("settings-screen").getElementsByClassName("go-back"),"click",function(e){e.preventDefault();document.getElementById("settings-screen").style.display="none";document.getElementById("main-screen").style.display="block";return!0});document.getElementById("save-settings").addEventListener("click",function(e){var t;e.preventDefault();t=a();l(t,!0)&&document.getElementById("settings-screen").getElementsByClassName("go-back")[0].click();return!0});e(document.getElementsByClassName("generate-password"),"click",function(e){var t;e.preventDefault();t=a();l(t,!1);s(t);return!0});u(!0);n()}).call(this);